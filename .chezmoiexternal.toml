# Macos packages are installed with brew
{{ if eq .chezmoi.os "linux" }}
    {{ if .nerdfonts }}
    ['.local/share/fonts/FiraCode']
    type = 'archive'
    url = '{{ gitHubLatestReleaseAssetURL "ryanoasis/nerd-fonts" "FiraCode.tar.xz" }}'
    extract = true
    include = ['*.ttf']
    refreshPeriod = '168h'

    ['.local/share/fonts/Meslo']
    type = 'archive'
    url = '{{ gitHubLatestReleaseAssetURL "ryanoasis/nerd-fonts" "Meslo.tar.xz" }}'
    extract = true
    include = ['*.ttf']
    refreshPeriod = '168h'
    {{ end }}

    {{ if .install.neovim }}
    ['.local/share/nvim-app']
    type = 'archive'
    {{ $arch := .chezmoi.arch }}
    {{ if eq $arch "amd64" }}{{ $arch = "x86_64" }}{{ end }}
    {{ $asset := printf "nvim-linux-%s.tar.gz" $arch }}
    url = '{{ gitHubLatestReleaseAssetURL "neovim/neovim" $asset }}'
    extract = true
    stripComponents = 1
    refreshPeriod = '168h'

    ['.local/bin/tree-sitter']
    type = 'file'
    {{ $arch := .chezmoi.arch }}
    {{ if eq $arch "amd64" }}{{ $arch = "x64" }}{{ end }}
    {{ $os := .chezmoi.os }}
    {{ if eq $os "darwin" }}{{ $os = "macos" }}
    {{ end }}
    {{ $asset := printf "tree-sitter-%s-%s.gz" $os $arch }}
    url = '{{ gitHubLatestReleaseAssetURL "tree-sitter/tree-sitter" $asset }}'
    extract = true
    path = 'tree-sitter'
    decompress = 'gzip'
    stripComponents = 1
    executable = true
    refreshPeriod = '168h'
    {{ end }}

    {{ if .install.zellij }}
    ['.local/bin/zellij']
    type = 'archive-file'
    {{ $arch := .chezmoi.arch }}
    {{ if eq $arch "amd64" }}{{ $arch = "x86_64" }}{{ end }}
    {{ if eq $arch "arm64" }}{{ $arch = "aarch64" }}{{ end }}
    {{ $asset := printf "zellij-%s-unknown-linux-musl.tar.gz" $arch }}
    url = '{{ gitHubLatestReleaseAssetURL "zellij-org/zellij" $asset }}'
    executable = true
    path = "zellij"
    refreshPeriod = "168h"
    {{ end }}

    {{ if .install.fd }}
    ['.local/bin/fd']
    type = 'archive-file'
    {{ $arch := .chezmoi.arch }}
    {{ if eq $arch "amd64" }}{{ $arch = "x86_64" }}{{ end }}
    {{ if eq $arch "arm64" }}{{ $arch = "aarch64" }}{{ end }}
    {{ $asset := printf "fd-v*-%s-unknown-linux-musl.tar.gz" $arch }}
    url = '{{ gitHubLatestReleaseAssetURL "sharkdp/fd" $asset }}'
    executable = true
    path = "fd"
    stripComponents = 1
    refreshPeriod = "168h"
    {{ end }}

    {{ if .install.sd }}
    ['.local/bin/sd']
    type = 'archive-file'
    {{ $arch := .chezmoi.arch }}
    {{ if eq $arch "amd64" }}{{ $arch = "x86_64" }}{{ end }}
    {{ if eq $arch "arm64" }}{{ $arch = "aarch64" }}{{ end }}
    {{ $asset := printf "sd-v*-%s-unknown-linux-musl.tar.gz" $arch }}
    url = '{{ gitHubLatestReleaseAssetURL "chmln/sd" $asset }}'
    executable = true
    path = "sd"
    stripComponents = 1
    refreshPeriod = "168h"
    {{ end }}

    {{ if .install.lsd }}
    ['.local/bin/lsd']
    type = 'archive-file'
    {{ $arch := .chezmoi.arch }}
    {{ if eq $arch "amd64" }}{{ $arch = "x86_64" }}{{ end }}
    {{ if eq $arch "arm64" }}{{ $arch = "aarch64" }}{{ end }}
    {{ $asset := printf "lsd-v*-%s-unknown-linux-musl.tar.gz" $arch }}
    url = '{{ gitHubLatestReleaseAssetURL "lsd-rs/lsd" $asset }}'
    executable = true
    path = "lsd"
    stripComponents = 1
    refreshPeriod = "168h"
    {{ end }}

    {{ if .install.bottom }}
    ['.local/bin/btm']
    type = 'archive-file'
    {{ $arch := .chezmoi.arch }}
    {{ if eq $arch "amd64" }}{{ $arch = "x86_64" }}{{ end }}
    {{ if eq $arch "arm64" }}{{ $arch = "aarch64" }}{{ end }}
    {{ $asset := printf "bottom_%s-unknown-linux-musl.tar.gz" $arch }}
    url = '{{ gitHubLatestReleaseAssetURL "ClementTsang/bottom" $asset }}'
    executable = true
    path = "btm"
    refreshPeriod = "168h"
    {{ end }}

    {{ if .install.fzf }}
    ['.local/bin']
    type = 'archive'
    {{ $asset := printf "fzf-*-linux_%s.tar.gz" .chezmoi.arch }}
    url = '{{ gitHubLatestReleaseAssetURL "junegunn/fzf" $asset }}'
    extract = true
    refreshPeriod = '168h'
    {{ end }}

    {{ if .install.nushell }}
    ['.local/bin/nu']
    type = 'archive-file'
    {{ $arch := .chezmoi.arch }}
    {{ if eq $arch "amd64" }}{{ $arch = "x86_64" }}{{ end }}
    {{ if eq $arch "arm64" }}{{ $arch = "aarch64" }}{{ end }}
    {{ $asset := printf "nu-*-%s-unknown-linux-musl.tar.gz" $arch }}
    url = '{{ gitHubLatestReleaseAssetURL "nushell/nushell" $asset }}'
    path = "nu"
    stripComponents = 1
    executable = true
    refreshPeriod = "168h"
    {{ end }}

    {{ if .install.fnm }}
    ['.local/bin/fnm']
    type = 'archive-file'
    {{ $arch := .chezmoi.arch }}
    # fnm has a confusing release naming scheme
    {{ if eq $arch "amd64" }}{{ $arch = "linux" }}{{ end }}
    {{ $asset := printf "fnm-%s.zip" $arch }}
    url = '{{ gitHubLatestReleaseAssetURL "Schniz/fnm" $asset }}'
    executable = true
    path = "fnm"
    refreshPeriod = "168h"
    {{ end }}

    {{ if .install.codex }}
    ['.local/bin/codex']
    type = 'archive-file'
    {{ $arch := .chezmoi.arch }}
    {{ if eq $arch "amd64" }}{{ $arch = "x86_64" }}{{ end }}
    {{ if eq $arch "arm64" }}{{ $arch = "aarch64" }}{{ end }}
    {{ $asset := printf "codex-%s-unknown-linux-musl.tar.gz" $arch }}
    url = '{{ gitHubLatestReleaseAssetURL "openai/codex" $asset }}'
    executable = true
    path = 'codex-{{ $arch }}-unknown-linux-musl'
    refreshPeriod = "168h"
    {{ end }}
{{ end }}

{{ if .install.zsh }}
['.local/share/zsh/oh-my-zsh']
type = 'git-repo'
url = 'https://github.com/ohmyzsh/ohmyzsh.git'
refreshPeriod = '168h'

['.local/share/zsh/zsh-completions']
type = 'archive'
{{ $tag := (gitHubLatestRelease "zsh-users/zsh-completions").TagName }}
url = 'https://github.com/zsh-users/zsh-completions/archive/refs/tags/{{ $tag }}.tar.gz'
exact = true
stripComponents = 2
include = ['*/src/_*']
refreshPeriod = '168h'

['.local/share/zsh/zsh-autosuggestions']
type = 'git-repo'
url = 'https://github.com/zsh-users/zsh-autosuggestions.git'
refreshPeriod = '168h'

['.local/share/zsh/zsh-syntax-highlighting']
type = 'git-repo'
url = 'https://github.com/zsh-users/zsh-syntax-highlighting.git'
refreshPeriod = '168h'

['.local/share/zsh/zsh-transient-prompt']
type = 'git-repo'
url = 'https://github.com/olets/zsh-transient-prompt.git'
refreshPeriod = '168h'
{{ end }}

{{ if .install.tinty }}
['.local/bin/tinty']
type = 'archive-file'
{{ $arch := .chezmoi.arch }}
{{ if eq $arch "amd64" }}{{ $arch = "x86_64" }}
{{ else if eq $arch "arm64" }}{{ $arch = "aarch64" }}
{{ end }}
{{ $asset := "" }}
{{ if eq .chezmoi.os "darwin" }}
    {{ $asset = printf "tinty-%s-apple-darwin.tar.gz" $arch }}
{{ else if eq .chezmoi.os "linux" }}
    {{ $asset = printf "tinty-%s-unknown-linux-musl.tar.gz" $arch }}
{{ end }}
url = '{{ gitHubLatestReleaseAssetURL "tinted-theming/tinty" $asset }}'
path = "tinty"
executable = true
refreshPeriod = "168h"
{{ end }}

{{ if .install.zellij }}
['.local/share/zellij/zjstatus.wasm']
type = 'file'
url = 'https://github.com/dj95/zjstatus/releases/latest/download/zjstatus.wasm'
refreshPeriod = "169h"
{{ end }}

{{ if .install.mods }}
['.local/bin/mods']
type = 'archive-file'
{{ $arch := .chezmoi.arch }}
{{ if eq $arch "amd64" }}{{ $arch = "x86_64" }}
{{ end }}
{{ $os := .chezmoi.os }}
{{ if eq $os "darwin" }}{{ $os = "Darwin" }}
{{ else if eq $os "linux" }}{{ $os = "Linux" }}
{{ end }}
{{ $asset := printf "mods_*_%s_%s.tar.gz" $os $arch }}
url = '{{ gitHubLatestReleaseAssetURL "charmbracelet/mods" $asset }}'
path = "mods"
stripComponents = 1
executable = true
refreshPeriod = "168h"
{{ end }}
